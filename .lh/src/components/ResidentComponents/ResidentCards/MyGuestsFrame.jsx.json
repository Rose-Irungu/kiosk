{
    "sourceFile": "src/components/ResidentComponents/ResidentCards/MyGuestsFrame.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1755249551233,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1755249653910,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,115 @@\n+import React, { useState, useEffect } from 'react';\r\n+import { useNavigate } from 'react-router-dom';\r\n+import { visitsuser, approveVisit, cancelVisit,  } from \"../../../services/visitsuser\";\r\n+\r\n+import CardA from './CardA';\r\n+\r\n+const MyGuestsFrame = () => {\r\n+  const navigate = useNavigate();\r\n+  const [activeTab, setActiveTab] = useState('pending');\r\n+  const [guestList, setGuestList] = useState([]);\r\n+  const [loading, setLoading] = useState(true);\r\n+  const [error, setError] = useState(null);\r\n+\r\n+  useEffect(() => {\r\n+    const fetchGuests = async () => {\r\n+      try {\r\n+        const response = await visitsuser();\r\n+        console.log(response);\r\n+        // const guestsData = Array.isArray(response?.data) ? response.data : [];\r\n+        setGuestList(response.data);\r\n+      } catch (err) {\r\n+        console.error('API fetch error:', err);\r\n+        setError('Could not load guest data.');\r\n+      } finally {\r\n+        setLoading(false);\r\n+      }\r\n+    };\r\n+\r\n+    fetchGuests();\r\n+  }, []);\r\n+\r\n+  const handleApproveVisit = async (visitId) => {\r\n+    try {\r\n+      await approveVisit(visitId);\r\n+\r\n+      setGuestList((prev) =>\r\n+        prev.map((g) => g.visit_id === visitId ? { ...g, status: 'approved' } : g)\r\n+      );\r\n+    } catch (error) {\r\n+      console.error('Approve failed', error);\r\n+    }\r\n+  };\r\n+\r\n+  const handleCancelVisit = async (visitId) => {\r\n+    try {\r\n+      await cancelVisit(visitId);\r\n+      \r\n+      setGuestList((prev) =>\r\n+        prev.map((g) => g.visit_id === visitId ? { ...g, status: 'cancelled' } : g)\r\n+      );\r\n+    } catch (error) {\r\n+      console.error('Cancel failed', error);\r\n+    }\r\n+  };\r\n+\r\n+\r\n+  const filteredGuests = guestList.filter((guest) => guest.status === activeTab);\r\n+\r\n+  return (\r\n+    <div className=\"bg-[#e6fbe9] rounded-xl px-2 py-3 flex flex-col gap-4 items-center justify-start overflow-y-auto relative max-h-[90vh]\">\r\n+\r\n+      <div className=\"flex items-center justify-between w-full px-4\">\r\n+        <div className=\"flex items-center gap-3\">\r\n+          <img src=\"/fluent-people-20-filled0.svg\" className=\"w-8 h-8\" />\r\n+          <h2 className=\"text-green-900 text-2xl font-semibold\">My Guests</h2>\r\n+        </div>\r\n+        <button\r\n+          onClick={() => window.open(`${window.location.origin}/guestform`, '_blank')}\r\n+\r\n+          className=\"bg-green-600 shadow-md rounded-md flex items-center gap-1 px-3 py-1\"\r\n+        >\r\n+          <img src=\"/ic-round-plus0.svg\" className=\"w-6 h-6\" />\r\n+          <span className=\"text-white text-sm font-semibold -ml-1\">Invite Guest</span>\r\n+        </button>\r\n+      </div>\r\n+\r\n+      <div className=\"flex flex-col gap-4 items-center w-full  px-4\">\r\n+        <div className=\"bg-[rgba(51,51,51,0.1)] bg-opacity-80 rounded-full px-2 py-1 flex gap-4 w-full\">\r\n+          {Object.entries({ 'Pending': 'pending', 'Expected': 'approved', 'On-Site': 'checked_in' }).map(\r\n+            ([label, value]) => (\r\n+              <div\r\n+                key={value}\r\n+                onClick={() => setActiveTab(value)}\r\n+                className={`rounded-full w-[315px] h-8  flex items-center justify-center text-sm font-semibold cursor-pointer ${activeTab === value ? 'bg-[#b0f1b9]' : 'bg-white'\r\n+                  }`}\r\n+              >\r\n+                {label} ({guestList.filter((g) => g.status === value).length})\r\n+              </div>\r\n+            )\r\n+          )}\r\n+        </div>\r\n+\r\n+\r\n+        <div className=\"flex gap-3 w-full\">\r\n+          <div className=\"flex flex-col gap-2 w-full max-w-[932px]\">\r\n+            {loading && <div className=\"text-gray-600 text-sm\">Loading guests...</div>}\r\n+            {error && <div className=\"text-red-600 text-sm\">Error: {error}</div>}\r\n+            {!loading && !error && guestList.length === 0 && (\r\n+              <div className=\"text-gray-600 text-sm\">No guests found.</div>\r\n+            )}\r\n+            {!loading &&\r\n+              !error &&\r\n+              filteredGuests.map((guest, index) => <CardA key={index}\r\n+                {...guest}\r\n+                onApproveVisit={handleApproveVisit}\r\n+                onCancelVisit={handleCancelVisit} />)\r\n+            }\r\n+          </div>\r\n+        </div>\r\n+      </div>\r\n+    </div>\r\n+  );\r\n+};\r\n+\r\n+export default MyGuestsFrame;\r\n"
                }
            ],
            "date": 1755249551233,
            "name": "Commit-0",
            "content": "import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { visitsuser, approveVisit, cancelVisit,  } from \"../../../services/visitsuser\";\r\n\r\nimport CardA from './CardA';\r\n\r\nconst MyGuestsFrame = () => {\r\n  const navigate = useNavigate();\r\n  const [activeTab, setActiveTab] = useState('pending');\r\n  const [guestList, setGuestList] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const fetchGuests = async () => {\r\n      try {\r\n        const response = await visitsuser();\r\n        console.log(response);\r\n        // const guestsData = Array.isArray(response?.data) ? response.data : [];\r\n        setGuestList(response.data);\r\n      } catch (err) {\r\n        console.error('API fetch error:', err);\r\n        setError('Could not load guest data.');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchGuests();\r\n  }, []);\r\n\r\n  const handleApproveVisit = async (visitId) => {\r\n    try {\r\n      await approveVisit(visitId);\r\n      // âœ… Refresh guest list\r\n      setGuestList((prev) =>\r\n        prev.map((g) => g.visit_id === visitId ? { ...g, status: 'approved' } : g)\r\n      );\r\n    } catch (error) {\r\n      console.error('Approve failed', error);\r\n    }\r\n  };\r\n\r\n  const handleCancelVisit = async (visitId) => {\r\n    try {\r\n      await cancelVisit(visitId);\r\n      \r\n      setGuestList((prev) =>\r\n        prev.map((g) => g.visit_id === visitId ? { ...g, status: 'cancelled' } : g)\r\n      );\r\n    } catch (error) {\r\n      console.error('Cancel failed', error);\r\n    }\r\n  };\r\n\r\n\r\n  const filteredGuests = guestList.filter((guest) => guest.status === activeTab);\r\n\r\n  return (\r\n    <div className=\"bg-[#e6fbe9] rounded-xl px-2 py-3 flex flex-col gap-4 items-center justify-start overflow-y-auto relative max-h-[90vh]\">\r\n\r\n      <div className=\"flex items-center justify-between w-full px-4\">\r\n        <div className=\"flex items-center gap-3\">\r\n          <img src=\"/fluent-people-20-filled0.svg\" className=\"w-8 h-8\" />\r\n          <h2 className=\"text-green-900 text-2xl font-semibold\">My Guests</h2>\r\n        </div>\r\n        <button\r\n          onClick={() => navigate('/guestform')}\r\n          className=\"bg-green-600 shadow-md rounded-md flex items-center gap-1 px-3 py-1\"\r\n        >\r\n          <img src=\"/ic-round-plus0.svg\" className=\"w-6 h-6\" />\r\n          <span className=\"text-white text-sm font-semibold -ml-1\">Invite Guest</span>\r\n        </button>\r\n      </div>\r\n\r\n      <div className=\"flex flex-col gap-4 items-center w-full  px-4\">\r\n        <div className=\"bg-[rgba(51,51,51,0.1)] bg-opacity-80 rounded-full px-2 py-1 flex gap-4 w-full\">\r\n          {Object.entries({ 'Pending': 'pending', 'Expected': 'approved', 'On-Site': 'checked_in' }).map(\r\n            ([label, value]) => (\r\n              <div\r\n                key={value}\r\n                onClick={() => setActiveTab(value)}\r\n                className={`rounded-full w-[315px] h-8  flex items-center justify-center text-sm font-semibold cursor-pointer ${activeTab === value ? 'bg-[#b0f1b9]' : 'bg-white'\r\n                  }`}\r\n              >\r\n                {label} ({guestList.filter((g) => g.status === value).length})\r\n              </div>\r\n            )\r\n          )}\r\n        </div>\r\n\r\n\r\n        <div className=\"flex gap-3 w-full\">\r\n          <div className=\"flex flex-col gap-2 w-full max-w-[932px]\">\r\n            {loading && <div className=\"text-gray-600 text-sm\">Loading guests...</div>}\r\n            {error && <div className=\"text-red-600 text-sm\">Error: {error}</div>}\r\n            {!loading && !error && guestList.length === 0 && (\r\n              <div className=\"text-gray-600 text-sm\">No guests found.</div>\r\n            )}\r\n            {!loading &&\r\n              !error &&\r\n              filteredGuests.map((guest, index) => <CardA key={index}\r\n                {...guest}\r\n                onApproveVisit={handleApproveVisit}\r\n                onCancelVisit={handleCancelVisit} />)\r\n            }\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MyGuestsFrame;\r\n"
        }
    ]
}