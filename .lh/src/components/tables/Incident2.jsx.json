{
    "sourceFile": "src/components/tables/Incident2.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1754660061515,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1754660061515,
            "name": "Commit-0",
            "content": "import React, { useState, useEffect } from \"react\";\r\nimport {\r\n  Table, TableBody, TableCaption,\r\n  TableCell, TableHead, TableHeader,\r\n  TableRow,\r\n} from \"@/components/ui/table\";\r\nimport { MoreHorizontal, Eye, User, FileText, X } from \"lucide-react\";\r\n\r\nconst statusStyles = {\r\n  new: \"bg-red-100 text-red-700\",\r\n  under_review: \"bg-yellow-100 text-yellow-700\",\r\n  resolved: \"bg-green-100 text-green-700\",\r\n};\r\n\r\nexport default function SecurityIncidentTable({ incidentReports = [] }) {\r\n  const [incidents, setIncidents] = useState(incidentReports);\r\n  const [actionsFor, setActionsFor] = useState(null);\r\n  const [selected, setSelected] = useState(null);\r\n\r\n  useEffect(() => {\r\n    setIncidents(incidentReports);\r\n  }, [incidentReports]);\r\n\r\n  const formatStatus = s => {\r\n    if (s === \"new\") return \"New Incident\";\r\n    if (s === \"under_review\") return \"Under Review\";\r\n    if (s === \"resolved\") return \"Resolved\";\r\n    return s;\r\n  };\r\n\r\n  const updateStatus = (id, newStatus) => {\r\n    setIncidents(prev =>\r\n      prev.map(r => (r.id === id ? { ...r, incident_status: newStatus } : r))\r\n    );\r\n    setActionsFor(null);\r\n  };\r\n\r\n  \r\n\r\n  return (\r\n    <div className=\"relative max-w-6xl mx-auto bg-white rounded-xl shadow-sm\">\r\n      {/* Header */}\r\n      <div className=\"flex justify-between items-center p-6 pb-4\">\r\n        <h2 className=\"text-xl font-semibold\">Reported Incidents</h2>\r\n        <select className=\"h-10 px-3 rounded-md border text-sm\">\r\n          {[\"This Week\", \"Today\", \"This Month\", \"This Year\"].map(opt => (\r\n            <option key={opt}>{opt}</option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      \r\n      <div className=\"overflow-auto\">\r\n        <Table>\r\n          <TableCaption className=\"sr-only\">Incident reports</TableCaption>\r\n          <TableHeader>\r\n            <TableRow className=\"border-b\">\r\n              {[\r\n                \"Reporter Name\",\r\n                \"Reporter Role\",\r\n                \"Incident Type\",\r\n                \"Short Description\",\r\n                \"Status\",\r\n                \"Action\",\r\n              ].map(h => (\r\n                <TableHead key={h}>{h}</TableHead>\r\n              ))}\r\n            </TableRow>\r\n          </TableHeader>\r\n          <TableBody>\r\n            {incidents.map(r => (\r\n              <TableRow key={r.id} className=\"hover:bg-gray-50 border-b\">\r\n                <TableCell>{r.reporter_name}</TableCell>\r\n                <TableCell className=\"capitalize\">{r.reporter_role}</TableCell>\r\n                <TableCell>{r.incident_type.replace(/_/g, \" \")}</TableCell>\r\n                <TableCell>\r\n                  {r.incident_description.slice(0, 50)}...\r\n                </TableCell>\r\n                <TableCell>\r\n                  <span\r\n                    className={`text-xs px-3 py-1 rounded-full ${\r\n                      statusStyles[r.incident_status] || \"\"\r\n                    }`}\r\n                  >\r\n                    {formatStatus(r.incident_status)}\r\n                  </span>\r\n                </TableCell>\r\n                <TableCell className=\"relative overflow-visible\">\r\n                  <button\r\n                    onClick={() =>\r\n                      setActionsFor(actionsFor === r.id ? null : r.id)\r\n                    }\r\n                    className=\"p-2 rounded hover:bg-gray-100 overflow-visible\"\r\n                  >\r\n                    <MoreHorizontal />\r\n                  </button>\r\n\r\n                  {actionsFor === r.id && (\r\n                    <div className=\"absolute right-0 top-10 bg-white border rounded-lg shadow-lg z-20 w-48 overflow-visible sticky-bottom-0\">\r\n                      <button\r\n                        onClick={() => {\r\n                          setSelected(r);\r\n                          setActionsFor(null);\r\n                        }}\r\n                        className=\"flex items-center w-full px-4 py-2 hover:bg-gray-50\"\r\n                      >\r\n                        <Eye className=\"mr-2\" /> View Details\r\n                      </button>\r\n                      <div className=\"border-t my-1\" />\r\n                      {[\"new\", \"under_review\", \"resolved\"].map(st =>\r\n                        r.incident_status !== st ? (\r\n                          <button\r\n                            key={st}\r\n                            onClick={() => updateStatus(r.id, st)}\r\n                            className={`flex w-full px-4 py-2 text-sm ${\r\n                              st === \"new\"\r\n                                ? \"text-red-700 hover:bg-red-50\"\r\n                                : st === \"under_review\"\r\n                                ? \"text-yellow-700 hover:bg-yellow-50\"\r\n                                : \"text-green-700 hover:bg-green-50\"\r\n                            }`}\r\n                          >\r\n                            Mark as {formatStatus(st)}\r\n                          </button>\r\n                        ) : null\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                </TableCell>\r\n              </TableRow>\r\n            ))}\r\n          </TableBody>\r\n        </Table>\r\n      </div>\r\n\r\n{selected && (\r\n  <div className=\"absolute inset-0 bg-gray-100 rounded-lg   border-hidden  \">\r\n    {/* Header */}\r\n    <div className=\"flex justify-between items-center bg-white shadow rounded px-4 py-2 mb-4\">\r\n      <div className=\"flex items-center gap-2\">\r\n        <div className=\"w-2 place-self-start h-10 bg-green-500 rounded\" />\r\n        <h2 className=\"text-xl font-semibold capitalize\">\r\n          {selected.incident_type.replace(/_/g, \" \")}\r\n        </h2>\r\n      </div>\r\n      <div className=\"flex items-center gap-2\">\r\n\r\n      </div>\r\n      <div className=\"flex items-center gap-4\">\r\n        <span\r\n          className={`text-xs px-3 py-1 rounded-full ${\r\n            statusStyles[selected.incident_status]\r\n          }`}\r\n        >\r\n          {formatStatus(selected.incident_status)}\r\n        </span>\r\n        <button onClick={() => setSelected(null)} className=\"p-1 rounded hover:bg-gray-100\">\r\n          <X />\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n    \r\n    <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\r\n      \r\n      <div className=\"lg:col-span-1  bg-white shadow rounded p-4\">\r\n        <div className=\"flex items-center gap-2 mb-2\">\r\n          <FileText className=\"text-gray-500\" />\r\n          <h3 className=\"text-lg font-medium\">Incident Description</h3>\r\n        </div>\r\n        <div className=\"bg-gray-50 rounded p-4\">\r\n          <p className=\"text-gray-700\">{selected.incident_description}</p>\r\n        </div>\r\n      </div>\r\n\r\n      \r\n      <div className=\"grid grid-cols-2 bg-white shadow rounded p-4 space-y-6 flex \">\r\n        \r\n        <div >\r\n          <div className=\"flex items-center gap-2 mb-2\">\r\n            <User className=\"text-gray-500\" />\r\n            <h3 className=\"text-lg font-medium\">Reporter Information</h3>\r\n          </div>\r\n          <div className=\"bg-gray-50 rounded p-4 space-y-2\">\r\n            <div>\r\n              <span className=\"text-sm text-gray-500\">Name:</span>\r\n              <p className=\"font-medium\">{selected.reporter_name}</p>\r\n            </div>\r\n            <div>\r\n              <span className=\"text-sm text-gray-500\">Role:</span>\r\n              <p className=\"font-medium capitalize\">{selected.reporter_role}</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        \r\n        <div>\r\n          <h3 className=\"text-lg font-medium mb-2\">Photo</h3>\r\n          <div className=\"bg-gray-100 rounded overflow-hidden aspect-square flex items-center justify-center\">\r\n            {selected.photo_url ? (\r\n              <img\r\n                src={selected.photo_url}\r\n                alt=\"Incident\"\r\n                className=\"object-cover \"\r\n              />\r\n            ) : (\r\n              <div className=\"text-gray-400 text-center p-4\">\r\n                {/* placeholder icon */}\r\n                <svg className=\"w-16 h-16 mx-auto mb-2\" fill=\"currentColor\" /*...*/ />\r\n                <p className=\"text-sm\">No photo available</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n)}\r\n</div>\r\n  );\r\n}\r\n"
        }
    ]
}